<!--pages/order/list/list.wxml-->
<view class="order-list-page">
  <!-- çŠ¶æ€ç­›é€‰æ  -->
  <view class="filter-bar">
    <view class="filter-item {{statusFilter === 'all' ? 'active' : ''}}" 
          data-status="all" 
          bindtap="switchStatusFilter">
      <text>å…¨éƒ¨</text>
    </view>
    <view class="filter-item {{statusFilter === 'pending' ? 'active' : ''}}" 
          data-status="pending" 
          bindtap="switchStatusFilter">
      <text>å¾…å¤„ç†</text>
    </view>
    <view class="filter-item {{statusFilter === 'processing' ? 'active' : ''}}" 
          data-status="processing" 
          bindtap="switchStatusFilter">
      <text>åˆ¶ä½œä¸­</text>
    </view>
    <view class="filter-item {{statusFilter === 'completed' ? 'active' : ''}}" 
          data-status="completed" 
          bindtap="switchStatusFilter">
      <text>å·²å®Œæˆ</text>
    </view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="order-list">
    <view class="order-card" wx:for="{{filteredOrders}}" wx:key="id" data-id="{{item.id}}" bindtap="goToDetail">
      <view class="order-header">
        <view class="order-info">
          <text class="order-id">è®¢å• #{{item.id ? item.id.substring(0, 8) : 'æœªçŸ¥'}}</text>
          <text class="order-time">{{formatTime(item.createTime)}}</text>
        </view>
        <view class="order-status" style="color: {{getStatusColor(item.status)}}">
          <text>{{getStatusText(item.status)}}</text>
        </view>
      </view>

      <view class="order-items">
        <view class="order-item" wx:for="{{item.items}}" wx:key="recipeId" wx:for-item="orderItem">
          <image class="item-image" src="{{orderItem.recipeImage || '/images/default-recipe.png'}}" mode="aspectFill"></image>
          <view class="item-info">
            <text class="item-name">{{orderItem.recipeName}}</text>
            <text class="item-quantity">x{{orderItem.quantity}}</text>
          </view>
          <text class="item-price">Â¥{{orderItem.price * orderItem.quantity}}</text>
        </view>
      </view>

      <view class="order-footer">
        <text class="total-price">åˆè®¡ï¼šÂ¥{{item.totalPrice}}</text>
        <view class="order-actions" wx:if="{{isAdmin}}">
          <view class="action-btn accept-btn" 
                wx:if="{{item.status === 'pending'}}" 
                catchtap="acceptOrder" 
                data-id="{{item.id}}">
            <text>æ¥å•</text>
          </view>
          <view class="action-btn complete-btn" 
                wx:if="{{item.status === 'processing'}}" 
                catchtap="completeOrder" 
                data-id="{{item.id}}">
            <text>å‡ºé¤</text>
          </view>
        </view>
      </view>
    </view>

    <view class="empty" wx:if="{{filteredOrders.length === 0 && statusFilter === 'all'}}">
      <text class="empty-icon">ğŸ“‹</text>
      <text class="empty-text">æš‚æ— è®¢å•</text>
      <text class="empty-tip">å¿«å»ä¸‹å•å§</text>
    </view>
    <view class="empty" wx:if="{{filteredOrders.length === 0 && statusFilter !== 'all'}}">
      <text class="empty-icon">ğŸ“­</text>
      <text class="empty-text">æš‚æ— {{getStatusText(statusFilter)}}è®¢å•</text>
    </view>
  </view>
</view>
